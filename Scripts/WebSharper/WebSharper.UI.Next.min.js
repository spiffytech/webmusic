(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br;$.Define($$,{WebSharper:{UI:{Next:{Abbrev:{Array:{MapReduce:function(bs,bt,bu,bv){var bw;bw=function(bx,by){var bz,bA,bB,bC,bD,bE;if(by<=0){return bt;}else{if(by===1){if(bx>=0?bx<a.length(bv):false){return bs(a.get(bv,bx));}else{bz=by/2>>0;bA=bw(bx,bz);bB=bw(bx+bz,by-bz);return(bu(bA))(bB);}}else{bC=by/2>>0;bD=bw(bx,bC);bE=bw(bx+bC,by-bC);return(bu(bD))(bE);}}};return bw(0,a.length(bv));}},Async:{Schedule:function(bE){return b.Start(b.Delay(function(){return b.Return(bE(null));}),{$:0});},StartTo:function(bG,bH){return b.StartWithContinuations(bG,bH,function(){},function(){},{$:0});}},Dict:{ToKeyArray:function(bK){var bL;bL=c(bK.count);d.iteri(function(bM){return function(bN){return a.set(bL,bM,bN.K);};},bK);return bL;},ToValueArray:function(bO){var bP;bP=c(bO.count);d.iteri(function(bQ){return function(bR){return a.set(bP,bQ,bR.V);};},bO);return bP;}},Fresh:{Id:function(){var bS;bS=h.counter()+1;h.counter=function(){return bS;};return"uid"+$$.String(h.counter());},Int:function(){var bT;bT=h.counter()+1;h.counter=function(){return bT;};return h.counter();},counter:$.Field(function(){return 0;})},HashSet:{Except:function(bU,bV){var bW;bW=j.New(k.ToArray(bV));bW.ExceptWith(k.ToArray(bU));return bW;},Filter:function(bX,bY){return j.New(a.filter(bX,k.ToArray(bY)));},Intersect:function(bZ,b0){var b1;b1=j.New(k.ToArray(bZ));b1.IntersectWith(k.ToArray(b0));return b1;},ToArray:function(b2){var b3;b3=c(b2.get_Count());b2.CopyTo(b3);return b3;}},JQueue:{Add:function($x,$q){var $0=this,$this=this;return $q.push($x);},Count:function(b4){return b4.length;},Dequeue:function($q){var $0=this,$this=this;return $q.shift();},Iter:function(b5,b6){return a.iter(b5,l.ToArray(b6));},ToArray:function(b7){return b7.slice();}},Mailbox:{StartProcessor:function(b8){var b9,b_,b$;b9=[];b_=[false];b$=b.Delay(function(){return b.Combine(b.While(function(){return l.Count(b9)>0;},b.Delay(function(){return b.Bind(b8(l.Dequeue(b9)),function(){return b.Return(null);});})),b.Delay(function(){return b.Return(void(b_[0]=false));}));});return function(cf){l.Add(cf,b9);if(!b_[0]){b_[0]=true;return b.Start(b$,{$:0});}else{return null;}};}},Slot:$.Class({},{New:function(cg,ch){var ci;ci=$.New(this,{});ci.key=cg;ci.value=ch;return ci;}}),Slot1:$.Class({Equals:function(cj){return m.Equals(this.key.call(null,this.value),this.key.call(null,cj.get_Value()));},GetHashCode:function(){return m.Hash(this.key.call(null,this.value));},get_Value:function(){return this.value;}},{Create:function(ck,cl){return n.New(ck,cl);}}),U:function(){return;}},An:$.Class({},{Append:function(cm,cn){return $.New(o,{$:0,$0:p.Append(cm.$0,cn.$0)});},Concat:function(co){return $.New(o,{$:0,$0:p.Concat(d.map(function(cp){return q.List(cp);},co))});},Const:function(cq){return q.Const(cq);},Delayed:function(cr,cs,ct,cu,cv,cw){return{Compute:function(cx){return cx<=cu?cv:cr.Interpolate(cs.TransformTime.call(null,(cx-cu)/ct),cv,cw);},Duration:ct+cu};},Map:function(cy,cz){var cA;cA=cz.Compute;return q.Def(cz.Duration,function(cB){return cy(cA(cB));});},Pack:function(cC){return $.New(o,{$:0,$0:p.Single({$:1,$0:cC})});},Play:function(cD){return b.Delay(function(){return b.Bind(o.Run(function(){},q.Actions(cD)),function(){return b.Return(q.Finalize(cD));});});},Run:function(cH,cI){var cJ;cJ=cI.Duration;return b.FromContinuations(function(cK){var cL,cM,cN;cL=cK[0];cM=function(){r.requestAnimationFrame(function(cP){return cN(cP,cP);});};cN=function(cQ,cR){var cS;cS=cR-cQ;cH(cI.Compute.call(null,cS));return cS<=cJ?void r.requestAnimationFrame(function(cT){return cN(cQ,cT);}):cL(null);};return cM(null);});},Simple:function(cU,cV,cW,cX,cY){return{Compute:function(cZ){return cU.Interpolate(cV.TransformTime.call(null,cZ/cW),cX,cY);},Duration:cW};},WhenDone:function(c0,c1){return o.Append($.New(o,{$:0,$0:p.Single({$:0,$0:c0})}),c1);},get_Empty:function(){return $.New(o,{$:0,$0:p.Empty()});}}),Anims:{Actions:function(c2){return q.ConcatActions(a.choose(function(c3){return c3.$==1?{$:1,$0:c3.$0}:{$:0};},p.ToArray(c2.$0)));},ConcatActions:function(c4){var c5,c6,c7,c9;c5=d.toArray(c4);c6=a.length(c5);if(c6===0){return q.Const(null);}else{if(c6===1){return a.get(c5,0);}else{c7=d.max(d.map(function(c8){return c8.Duration;},c5));c9=a.map(function(c_){return q.Prolong(c7,c_);},c5);return q.Def(c7,function(c$){return a.iter(function(da){return da.Compute.call(null,c$);},c9);});}}},Const:function(db){return q.Def(0,function(){return db;});},Def:function(dd,de){return{Compute:de,Duration:dd};},Finalize:function(df){return a.iter(function(dg){return dg.$==0?dg.$0.call(null,null):null;},p.ToArray(df.$0));},List:function(dh){return dh.$0;},Prolong:function(di,dj){var dk,dl,dm;dk=dj.Compute;dl=dj.Duration;dm=s.Create(function(){return dj.Compute.call(null,dj.Duration);});return{Compute:function(_do){return _do>=dl?dm.eval():dk(_do);},Duration:di};}},AppendList1:{Append:function(dp,dq){var dr;dr=[dp,dq];return dr[0].$==0?dr[1]:dr[1].$==0?dr[0]:{$:2,$0:dp,$1:dq};},Concat:function(ds){var dt;dt=d.toArray(ds);return t.MapReduce(function(du){return du;},p.Empty(),function(dv){return function(dw){return p.Append(dv,dw);};},dt);},Empty:function(){return{$:0};},FromArray:function(dx){var dy;dy=dx.length;return dy===0?{$:0}:dy===1?{$:1,$0:a.get(dx,0)}:{$:3,$0:dx.slice()};},Single:function(dz){return{$:1,$0:dz};},ToArray:function(dA){var dB,dC;dB=[];dC=function(dD){var dE;if(dD.$==1){return l.Add(dD.$0,dB);}else{if(dD.$==2){dE=dD.$1;dC(dD.$0);return dC(dE);}else{return dD.$==3?a.iter(function(dF){return l.Add(dF,dB);},dD.$0):null;}}};dC(dA);return l.ToArray(dB);}},Client:{AnimatedAttrNode:$.Class({GetChangeAnim:function(dG){var dH,dJ=this;dH=[this.visible,this.logical];return o.WhenDone(function(){return dJ.sync(dG);},dH[0].$==1?dH[1].$==1?dJ.dirty?o.Pack(o.Map(function(dK){return dJ.pushVisible(dG,dK);},u.AnimateChange(dJ.tr,dH[0].$0,dH[1].$0))):o.get_Empty():o.get_Empty():o.get_Empty());},GetEnterAnim:function(dL){var dM,dO=this;dM=[this.visible,this.logical];return o.WhenDone(function(){return dO.sync(dL);},dM[0].$==1?dM[1].$==1?dO.dirty?o.Pack(o.Map(function(dP){return dO.pushVisible(dL,dP);},u.AnimateChange(dO.tr,dM[0].$0,dM[1].$0))):dM[0].$==0?dM[1].$==1?o.Pack(o.Map(function(dQ){return dO.pushVisible(dL,dQ);},u.AnimateEnter(dO.tr,dM[1].$0))):o.get_Empty():o.get_Empty():dM[0].$==0?dM[1].$==1?o.Pack(o.Map(function(dR){return dO.pushVisible(dL,dR);},u.AnimateEnter(dO.tr,dM[1].$0))):o.get_Empty():o.get_Empty():dM[0].$==0?dM[1].$==1?o.Pack(o.Map(function(dS){return dO.pushVisible(dL,dS);},u.AnimateEnter(dO.tr,dM[1].$0))):o.get_Empty():o.get_Empty());},GetExitAnim:function(dT){var dU,dW=this;dU=this.visible;return o.WhenDone(function(){dW.dirty=true;dW.visible={$:0};return;},dU.$==1?o.Pack(o.Map(function(dX){return dW.pushVisible(dT,dX);},u.AnimateExit(dW.tr,dU.$0))):o.get_Empty());},Sync:function(){return null;},get_Changed:function(){return this.updates;},pushVisible:function(dZ,d0){this.visible={$:1,$0:d0};this.dirty=true;return(this.push.call(null,dZ))(d0);},sync:function(d1){if(this.dirty){v.iter(this.push.call(null,d1),this.logical);this.visible=this.logical;this.dirty=false;return;}else{return null;}}},{New:function(d2,d3,d4){var d5;d5=$.New(this,{});d5.tr=d2;d5.push=d4;d5.logical={$:0};d5.visible={$:0};d5.dirty=true;d5.updates=w.Map(function(d6){d5.logical={$:1,$0:d6};d5.dirty=true;return;},d3);return d5;}}),Attr:{Animated:function(d7,d8,d9,d_){return y.Animated(d8,d9,function(d$){return function(ea){return z.SetAttr(d$,d7,d_(ea));};});},AnimatedStyle:function(eb,ec,ed,ee){return y.Animated(ec,ed,function(ef){return function(eg){return z.SetStyle(ef,eb,ee(eg));};});},Class:function(eh){return y.Static(function(ei){return z.AddClass(ei,eh);});},Dynamic:function(ej,ek){return y.Dynamic(ek,function(el){return function(em){return z.SetAttr(el,ej,em);};});},DynamicClass:function(en,eo,ep){return y.Dynamic(eo,function(eq){return function(er){return ep(er)?z.AddClass(eq,en):z.RemoveClass(eq,en);};});},DynamicCustom:function(es,et){return y.Dynamic(et,es);},DynamicPred:function(eu,ev,ew){var ex;ex=function(ey){return function(ez){var eA;eA=ez[1];return ez[0]?z.SetAttr(ey,eu,eA):z.RemoveAttr(ey,eu);};};return y.Dynamic(w.Map2(function(eB){return function(eC){return[eB,eC];};},ev,ew),ex);},DynamicProp:function(eD,eE){return y.Dynamic(eE,function(eF){return function(eG){eF[eD]=eG;};});},DynamicStyle:function(eH,eI){return y.Dynamic(eI,function(eJ){return function(eK){return z.SetStyle(eJ,eH,eK);};});},Handler:function(eL,eM){return y.Static(function(eN){return eN.addEventListener(eL,eM(eN),false);});},Style:function(eO,eP){return y.Static(function(eQ){return z.SetStyle(eQ,eO,eP);});},Value:function(eR){var eS;eS=function(eT){return function(){return!m.Equals(eT.value,eR.get_Value())?A.Set(eR,eT.value):null;};};return B.Concat(C.ofArray([D.Handler("change",eS),D.Handler("input",eS),y.Dynamic(eR.get_View(),function(eV){return function(eW){return!m.Equals(eW,eV.value)?void(eV.value=eW):null;};})]));}},AttrProxy:$.Class({},{Append:function(eX,eY){return y.Mk(eX.Flags|eY.Flags,y.AppendTree(eX.Tree,eY.Tree));},Concat:function(eZ){var e0;e0=d.toArray(eZ);return t.MapReduce(function(e1){return e1;},B.get_Empty(),function(e2){return function(e3){return B.Append(e2,e3);};},e0);},Create:function(e4,e5){return y.Static(function(e6){return z.SetAttr(e6,e4,e5);});},Handler:function(e7,e8){return y.Static(function(e9){return e9.addEventListener(e7,e8(e9),false);});},get_Empty:function(){return y.EmptyAttr();}}),Attrs:{Animated:function(e_,e$,fa){var fb,fc;fb=E.New(e_,e$,fa);fc=4;if(u.CanAnimateEnter(e_)){fc=fc|1;}if(u.CanAnimateExit(e_)){fc=fc|2;}return y.Mk(fc,{$:1,$0:fb});},AppendTree:function(fd,fe){var ff;ff=[fd,fe];return ff[0].$==0?ff[1]:ff[1].$==0?ff[0]:{$:2,$0:fd,$1:fe};},Dynamic:function(fg,fh){return y.Mk(0,{$:1,$0:F.New(fg,fh)});},EmptyAttr:$.Field(function(){return y.Mk(0,{$:0});}),GetAnim:function(fi,fj){return o.Concat(a.map(function(fk){return(fj(fk))(fi.DynElem);},fi.DynNodes));},GetChangeAnim:function(fl){return y.GetAnim(fl,function(fm){return function(fn){return fm.GetChangeAnim(fn);};});},GetEnterAnim:function(fo){return y.GetAnim(fo,function(fp){return function(fq){return fp.GetEnterAnim(fq);};});},GetExitAnim:function(fr){return y.GetAnim(fr,function(fs){return function(ft){return fs.GetExitAnim(ft);};});},HasChangeAnim:function(fu){return(fu.DynFlags&4)!==0;},HasEnterAnim:function(fv){return(fv.DynFlags&1)!==0;},HasExitAnim:function(fw){return(fw.DynFlags&2)!==0;},Insert:function(fx,fy){var fz,fA;fz=[];fA=function(fB){var fC;if(fB.$==1){return l.Add(fB.$0,fz);}else{if(fB.$==2){fC=fB.$1;fA(fB.$0);return fA(fC);}else{return fB.$==3?fB.$0.call(null,fx):null;}}};fA(fy.Tree);return{DynElem:fx,DynFlags:fy.Flags,DynNodes:l.ToArray(fz)};},Mk:function(fD,fE){return $.New(B,{Flags:fD,Tree:fE});},Static:function(fF){return y.Mk(0,{$:3,$0:fF});},Sync:function(fG,fH){return a.iter(function(fI){return fI.Sync(fG);},fH.DynNodes);},Updates:function(fJ){var fK,fP;fK=function(fL){return function(fM){return w.Map2(function(){return function(){return null;};},fL,fM);};};fP=fJ.DynNodes;return t.MapReduce(function(fQ){return fQ.get_Changed();},G.Const(null),fK,fP);}},Doc:$.Class({ReplaceInDom:function(fR){var fS,fT,fU,fV,fW,fY=this;fS=H.createTextNode("");fT=H.createTextNode("");fU=fR.parentNode;fU.replaceChild(fT,fR);fU.insertBefore(fS,fT);I.LinkPrevElement(fT,this.docNode);fV=I.CreateDelimitedRunState(fS,fT,this.docNode);fW=this.updates;return G.Sink(J.StartProcessor(function(){return I.PerformAnimatedUpdate(fV,fY.docNode);}),fW);},get_DocNode:function(){return this.docNode;},get_ToDynDoc:function(){return;},get_Updates:function(){return this.updates;}},{Append:function(fZ,f0){var f1;f1=w.Map2(function(){return function(){return null;};},fZ.get_Updates(),f0.get_Updates());return K.Mk({$:0,$0:fZ.get_DocNode(),$1:f0.get_DocNode()},f1);},AsPagelet:function(f4){return L.New(f4);},Button:function(f5,f6,f7){var f8;f8=B.Concat(f6);return M.New1(K.Clickable("button",f7),f8,K.TextNode(f5));},CheckBox:function(f9,f_){var f$;f$=z.CreateElement("input");f$.addEventListener("click",function(){return A.Set(f_,f$.checked);},false);return M.New1(f$,B.Concat(d.toList(d.delay(function(){return d.append(f9,d.delay(function(){return d.append([B.Create("type","checkbox")],d.delay(function(){return[D.DynamicProp("checked",f_.get_View())];}));}));}))),K.get_Empty());},CheckBoxGroup:function(ge,gf,gg){var gh,gi,gk,gm,gn;gh=w.FromVar(gg);gi=function(gj){return m.Equals(gj,gf);};gk=w.Map(function(gl){return d.exists(gi,gl);},gh);gm=B.Concat(C.append(C.ofArray([B.Create("type","checkbox"),B.Create("name",$$.String(N.GetId(gg))),B.Create("value",h.Id()),D.DynamicProp("checked",gk)]),C.ofSeq(ge)));gn=z.CreateElement("input");gn.addEventListener("click",function(){var gp;gp=gn.checked;return N.Update(gg,function(gq){return d.toList(O.distinct(gp?C.append(gq,C.ofArray([gf])):C.filter(function(gr){return!m.Equals(gr,gf);},gq)));});},false);return M.New1(gn,gm,K.get_Empty());},Clickable:function(gs,gt){var gu;gu=z.CreateElement(gs);gu.addEventListener("click",function(gv){gv.preventDefault();return gt(null);},false);return gu;},Concat:function(gw){var gx;gx=d.toArray(gw);return t.MapReduce(function(gy){return gy;},K.get_Empty(),function(gz){return function(gA){return K.Append(gz,gA);};},gx);},Convert:function(gB,gC){return K.Flatten(w.Convert(gB,gC));},ConvertBy:function(gD,gE,gF){return K.Flatten(w.ConvertBy(gD,gE,gF));},ConvertSeq:function(gG,gH){return K.Flatten(w.ConvertSeq(gG,gH));},ConvertSeqBy:function(gI,gJ,gK){return K.Flatten(w.ConvertSeqBy(gI,gJ,gK));},Element:function(gL,gM,gN){var gO,gP;gO=B.Concat(gM);gP=K.Concat(gN);return M.New1(z.CreateElement(gL),gO,gP);},EmbedView:function(gQ){var gR,gS;gR=I.CreateEmbedNode();gS=w.Map(function(){},G.Bind(function(gU){I.UpdateEmbedNode(gR,gU.get_DocNode());return gU.get_Updates();},gQ));return K.Mk({$:2,$0:gR},gS);},Flatten:function(gV){return K.EmbedView(w.Map(function(gW){return K.Concat(gW);},gV));},FloatInput:function(gX,gY){return K.InputInternal(gX,gY,{$:1,$0:"number"});},Input:function(gZ,g0){return K.InputInternal(gZ,g0,{$:0});},InputArea:function(g1,g2){return K.InputInternal(g1,g2,{$:2});},InputInternal:function(g3,g4,g5){var g6,g7;g6=g5.$==1?[B.Append(B.Create("type",g5.$0),B.Concat(g3)),"input"]:g5.$==2?[B.Concat(g3),"textarea"]:[B.Concat(g3),"input"];g7=g6[0];return M.New1(z.CreateElement(g6[1]),B.Append(g7,D.Value(g4)),K.get_Empty());},IntInput:function(g8,g9){return K.InputInternal(g8,g9,{$:1,$0:"number"});},Link:function(g_,g$,ha){var hb,hc;hb=B.Concat(g$);hc=B.Append(B.Create("href","#"),hb);return M.New1(K.Clickable("a",ha),hc,K.TextNode(g_));},Mk:function(hd,he){return K.New(hd,he);},New:function(hf,hg){var hh;hh=$.New(this,{});hh.docNode=hf;hh.updates=hg;return hh;},PasswordBox:function(hi,hj){return K.InputInternal(hi,hj,{$:1,$0:"password"});},Radio:function(hk,hl,hm){var hn,hp,hr;hn=z.CreateElement("input");hn.addEventListener("click",function(){return A.Set(hm,hl);},false);hp=D.DynamicProp("checked",w.Map(function(hq){return m.Equals(hq,hl);},hm.get_View()));hr=function(hs,ht){return B.Create(hs,ht);};return M.New1(hn,B.Concat(C.append(C.ofArray([hr("type","radio"),hr("name",$$.String(N.GetId(hm))),hp]),C.ofSeq(hk))),K.get_Empty());},Run:function(hu,hv){var hw,hx;hw=hv.get_DocNode();I.LinkElement(hu,hw);hx=I.CreateRunState(hu,hw);return G.Sink(J.StartProcessor(function(){return I.PerformAnimatedUpdate(hx,hw);}),hv.get_Updates());},RunById:function(hz,hA){var hB;hB=z.Doc().getElementById(hz);return m.Equals(hB,null)?P.FailWith("invalid id: "+hz):K.Run(hB,hA);},Select:function(hC,hD,hE,hF){var hG,hK,hL,hM,hO;hG=function(hH){return function(hI){hH.selectedIndex=d.findIndex(function(hJ){return m.Equals(hI,hJ);},hE);};};hK=z.CreateElement("select");hL=w.FromVar(hF);hM=D.DynamicCustom(hG,hL);hK.addEventListener("change",function(){return A.Set(hF,hE.get_Item(hK.selectedIndex));},false);hO=K.Concat(C.mapi(function(hP){return function(hQ){var hR;hR=K.TextNode(hD(hQ));return K.Element("option",C.ofArray([B.Create("value",$$.String(hP))]),C.ofArray([hR]));};},hE));return M.New1(hK,B.Append(hM,B.Concat(hC)),hO);},Static:function(hS){return M.New1(hS,B.get_Empty(),K.get_Empty());},SvgElement:function(hT,hU,hV){var hW,hX;hW=B.Concat(hU);hX=K.Concat(hV);return M.New1(z.CreateSvgElement(hT),hW,hX);},TextNode:function(hY){return K.Mk({$:5,$0:z.CreateText(hY)},G.Const(null));},TextView:function(hZ){var h0,h1;h0=I.CreateTextNode();h1=w.Map(function(h2){return I.UpdateTextNode(h0,h2);},hZ);return K.Mk({$:4,$0:h0},h1);},get_Empty:function(){return K.Mk({$:3},G.Const(null));}}),DocElemNode:$.Class({Equals:function(h3){return this.ElKey===h3.ElKey;},GetHashCode:function(){return this.ElKey;}}),Docs:{ComputeChangeAnim:function(h4,h5){var h6,h8;h6=function(h7){return y.HasChangeAnim(h7.Attr);};h8=function(h9){return Q.Filter(h6,h9);};return o.Concat(a.map(function(h_){return y.GetChangeAnim(h_.Attr);},Q.ToArray(Q.Intersect(h8(h4.PreviousNodes),h8(h5)))));},ComputeEnterAnim:function(h$,ia){return o.Concat(a.map(function(ib){return y.GetEnterAnim(ib.Attr);},Q.ToArray(Q.Except(h$.PreviousNodes,Q.Filter(function(ic){return y.HasEnterAnim(ic.Attr);},ia)))));},ComputeExitAnim:function(id,ie){return o.Concat(a.map(function(_if){return y.GetExitAnim(_if.Attr);},Q.ToArray(Q.Except(ie,Q.Filter(function(ig){return y.HasExitAnim(ig.Attr);},id.PreviousNodes)))));},CreateDelimitedElemNode:function(ih,ii,ij,ik){var il;il=ih.parentNode;I.LinkPrevElement(ii,ik);return $.New(R,{Attr:y.Insert(il,ij),Children:ik,Delimiters:[ih,ii],El:il,ElKey:h.Int()});},CreateDelimitedRunState:function(im,_in,io){return{PreviousNodes:Q.get_Empty(),Top:I.CreateDelimitedElemNode(im,_in,B.get_Empty(),io)};},CreateElemNode:function(ip,iq,ir){I.LinkElement(ip,ir);return $.New(R,{Attr:y.Insert(ip,iq),Children:ir,El:ip,ElKey:h.Int()});},CreateEmbedNode:function(){return{Current:{$:3},Dirty:false};},CreateRunState:function(is,it){return{PreviousNodes:Q.get_Empty(),Top:I.CreateElemNode(is,B.get_Empty(),it)};},CreateTextNode:function(){return{Text:z.CreateText(""),Dirty:false,Value:""};},DoSyncElement:function(iu){var iv,iw,iA,iC;iv=iu.El;iw=function(ix,iy){var iz;if(ix.$==1){return{$:1,$0:ix.$0.El};}else{if(ix.$==2){iz=ix.$0;if(iz.Dirty){iz.Dirty=false;return I.InsertDoc(iv,iz.Current,iy);}else{return iw(iz.Current,iy);}}else{return ix.$==3?iy:ix.$==4?{$:1,$0:ix.$0.Text}:ix.$==5?{$:1,$0:ix.$0}:iw(ix.$0,iw(ix.$1,iy));}}};iA=iu.El;S.Iter(function(iB){return z.RemoveNode(iA,iB);},S.Except(S.DocChildren(iu),S.Children(iu.El,$.GetOptional(iu.Delimiters))));iC=$.GetOptional(iu.Delimiters);iw(iu.Children,iC.$==1?{$:1,$0:iC.$0[1]}:{$:0});return;},DomNodes:$.Class({},{Children:function(iD,iE){var iF,iG,iH,iI,iJ;if(iE.$==1){iF=iE.$0[1];iG=iE.$0[0];iH=c.prototype.constructor.apply(c,[]);iI=iG.nextSibling;while(iI!==iF){iH.push(iI);iI=iI.nextSibling;}return $.New(S,{$:0,$0:iH});}else{iJ=iD.childNodes;return $.New(S,{$:0,$0:a.init(iD.childNodes.length,function(iK){return iJ[iK];})});}},DocChildren:function(iL){var iM,iN;iM=[];iN=function(iO){var iP;if(iO.$==2){return iN(iO.$0.Current);}else{if(iO.$==1){return l.Add(iO.$0.El,iM);}else{if(iO.$==3){return null;}else{if(iO.$==5){return null;}else{if(iO.$==4){return l.Add(iO.$0.Text,iM);}else{iP=iO.$1;iN(iO.$0);return iN(iP);}}}}}};iN(iL.Children);return $.New(S,{$:0,$0:l.ToArray(iM)});},Except:function(iQ,iR){var iS;iS=iQ.$0;return $.New(S,{$:0,$0:a.filter(function(iT){return d.forall(function(iU){return!(iT===iU);},iS);},iR.$0)});},FoldBack:function(iV,iW,iX){return a.foldBack(iV,iW.$0,iX);},Iter:function(iY,iZ){return a.iter(iY,iZ.$0);}}),InsertDoc:function(i0,i1,i2){var i3;if(i1.$==1){return I.InsertNode(i0,i1.$0.El,i2);}else{if(i1.$==2){i3=i1.$0;i3.Dirty=false;return I.InsertDoc(i0,i3.Current,i2);}else{return i1.$==3?i2:i1.$==4?I.InsertNode(i0,i1.$0.Text,i2):i1.$==5?I.InsertNode(i0,i1.$0,i2):I.InsertDoc(i0,i1.$0,I.InsertDoc(i0,i1.$1,i2));}}},InsertNode:function(i4,i5,i6){z.InsertAt(i4,i6,i5);return{$:1,$0:i5};},LinkElement:function(i7,i8){I.InsertDoc(i7,i8,{$:0});},LinkPrevElement:function(i9,i_){I.InsertDoc(i9.parentNode,i_,{$:1,$0:i9});},NodeSet:$.Class({},{Except:function(i$,ja){return $.New(Q,{$:0,$0:k.Except(i$.$0,ja.$0)});},Filter:function(jb,jc){return $.New(Q,{$:0,$0:k.Filter(jb,jc.$0)});},FindAll:function(jd){var je,jf;je=[];jf=function(jg){var jh,ji;if(jg.$==0){jh=jg.$1;jf(jg.$0);return jf(jh);}else{if(jg.$==1){ji=jg.$0;l.Add(ji,je);return jf(ji.Children);}else{return jg.$==2?jf(jg.$0.Current):null;}}};jf(jd);return $.New(Q,{$:0,$0:j.New(l.ToArray(je))});},Intersect:function(jj,jk){return $.New(Q,{$:0,$0:k.Intersect(jj.$0,jk.$0)});},IsEmpty:function(jl){return jl.$0.get_Count()===0;},ToArray:function(jm){return k.ToArray(jm.$0);},get_Empty:function(){return $.New(Q,{$:0,$0:j.New11()});}}),PerformAnimatedUpdate:function(jn,jo){return b.Delay(function(){var jq,jr,js;jq=Q.FindAll(jo);jr=I.ComputeChangeAnim(jn,jq);js=I.ComputeEnterAnim(jn,jq);return b.Bind(o.Play(o.Append(jr,I.ComputeExitAnim(jn,jq))),function(){I.SyncElemNode(jn.Top);return b.Bind(o.Play(js),function(){return b.Return(void(jn.PreviousNodes=jq));});});});},Sync:function(jv){var jw;jw=function(jx){var jy,jz,jA;if(jx.$==1){jy=jx.$0;I.SyncElement(jy);return jw(jy.Children);}else{if(jx.$==2){return jw(jx.$0.Current);}else{if(jx.$==3){return null;}else{if(jx.$==5){return null;}else{if(jx.$==4){jz=jx.$0;if(jz.Dirty){jz.Text.nodeValue=jz.Value;jz.Dirty=false;return;}else{return null;}}else{jA=jx.$1;jw(jx.$0);return jw(jA);}}}}}};return jw(jv);},SyncElemNode:function(jB){I.SyncElement(jB);return I.Sync(jB.Children);},SyncElement:function(jC){var jD;y.Sync(jC.El,jC.Attr);jD=function(jE){var jF,jG;if(jE.$==0){jF=jE.$1;return jD(jE.$0)?true:jD(jF);}else{if(jE.$==2){jG=jE.$0;return jG.Dirty?true:jD(jG.Current);}else{return false;}}};return jD(jC.Children)?I.DoSyncElement(jC):null;},UpdateEmbedNode:function(jH,jI){jH.Current=jI;jH.Dirty=true;return;},UpdateTextNode:function(jJ,jK){jJ.Value=jK;jJ.Dirty=true;return;}},DynamicAttrNode:$.Class({GetChangeAnim:function(){return o.get_Empty();},GetEnterAnim:function(){return o.get_Empty();},GetExitAnim:function(){return o.get_Empty();},Sync:function(jO){if(this.dirty){(this.push.call(null,jO))(this.value);this.dirty=false;return;}else{return null;}},get_Changed:function(){return this.updates;}},{New:function(jP,jQ){var jR;jR=$.New(this,{});jR.push=jQ;jR.value=g.U();jR.dirty=true;jR.updates=w.Map(function(jS){jR.value=jS;jR.dirty=true;return;},jP);return jR;}}),Elt:$.Class({AddClass:function($cls){var $this=this;return $this.elt.className+=" "+$cls;},Append:function(jT){var jU;jU=this.get_DocElemNode();jU.Children={$:0,$0:jU.Children,$1:jT.get_DocNode()};this.rvUpdates.set_Value(w.Map2(function(){return function(){return null;};},this.rvUpdates.get_Value(),jT.get_Updates()));I.InsertDoc(this.elt,jT.get_DocNode(),{$:0});return;},Clear:function(){this.get_DocElemNode().Children={$:3};this.rvUpdates.set_Value(G.Const(null));while(this.elt.hasChildNodes()){this.elt.removeChild(this.elt.firstChild);}return;},GetAttribute:function(jX){return this.elt.getAttribute(jX);},GetProperty:function(jY){return this.elt[jY];},GetText:function(){return this.elt.textContent;},GetValue:function(){return this.elt.value;},HasAttribute:function(jZ){return this.elt.hasAttribute(jZ);},HasClass:function(j0){return(new T("(\\s|^)"+j0+"(\\s|$)")).test(this.elt.className);},Html:function(){return this.elt.outerHTML;},Id:function(){return this.elt.id;},On:function(j1,j2){return this.elt.addEventListener(j1,j2(this.elt),false);},Prepend:function(j3){var j4,j7,j8;j4=this.get_DocElemNode();j4.Children={$:0,$0:j3.get_DocNode(),$1:j4.Children};this.rvUpdates.set_Value(w.Map2(function(){return function(){return null;};},this.rvUpdates.get_Value(),j3.get_Updates()));j7=this.elt.firstChild;j8=m.Equals(j7,null)?{$:0}:{$:1,$0:j7};I.InsertDoc(this.elt,j3.get_DocNode(),j8);return;},RemoveAttribute:function(j9){return this.elt.removeAttribute(j9);},RemoveClass:function(j_){this.elt.className=this.elt.className.replace(new T("(\\s|^)"+j_+"(\\s|$)")," ");},SetAttribute:function(j$,ka){return this.elt.setAttribute(j$,ka);},SetProperty:function(kb,kc){this.elt[kb]=kc;},SetStyle:function(kd,ke){this.elt.style[kd]=ke;},SetText:function(kf){this.get_DocElemNode().Children={$:3};this.rvUpdates.set_Value(G.Const(null));this.elt.textContent=kf;return;},SetValue:function(kg){this.elt.value=kg;},get_DocElemNode:function(){var kh;kh=this.docNode1;return kh.$==1?kh.$0:P.FailWith("Elt: Invalid docNode");},get_Element:function(){return this.elt;}},{New:function(ki,kj,kk,kl){var kn;kn=$.New(this,K.New(ki,kj));kn.docNode1=ki;kn.elt=kk;kn.rvUpdates=kl;return kn;},New1:function(ko,kp,kq){var kr,ks,kt,ku,kx;kr=I.CreateElemNode(ko,kp,kq.get_DocNode());ks=A.Create(kq.get_Updates());kt=y.Updates(kr.Attr);ku=function(){return function(){return null;};};kx=G.Bind(function(ky){return w.Map2(ku,kt,ky);},ks.get_View());return M.New({$:1,$0:kr},kx,ko,ks,kt);}}),UINextPagelet:$.Class({Render:function(){return K.RunById(this.divId,this.doc);},get_Body:function(){return this.body;}},{New:function(kz){var kA,kB,kC;kA=$.New(this,W.New());kA.doc=kz;kA.divId=h.Id();kC=kA.divId;kB=C.ofArray([X.Attr().NewAttr("id",kC)]);kA.body=Y.Tags().NewTag("div",kB).get_Body();return kA;}})},DomUtility:{AddClass:function(kD,kE){Z(kD).addClass(kE);},AppendTo:function(kF,kG){kF.appendChild(kG);},Clear:function(kH){while(kH.hasChildNodes()){kH.removeChild(kH.firstChild);}return;},ClearAttrs:function(kI){while(kI.hasAttributes()){kI.removeAttributeNode(kI.attributes.item(0));}return;},CreateAttr:function(kJ,kK){var kL;kL=z.Doc().createAttribute(kJ);kL.value=kK;return kL;},CreateElement:function(kM){return z.Doc().createElement(kM);},CreateSvgElement:function(kN){return z.Doc().createElementNS("http://www.w3.org/2000/svg",kN);},CreateText:function(kO){return z.Doc().createTextNode(kO);},Doc:$.Field(function(){return H;}),InsertAt:function(kP,kQ,kR){var kS,kT,kU;if(kR.parentNode===kP){kT=kR.nextSibling;kU=[kQ,m.Equals(kT,null)?{$:0}:{$:1,$0:kT}];kS=kU[0].$==1?kU[1].$==1?kU[0].$0===kU[1].$0:false:kU[1].$==0?true:false;}else{kS=false;}return!kS?kQ.$==1?void kP.insertBefore(kR,kQ.$0):void kP.appendChild(kR):null;},RemoveAttr:function(kV,kW){return kV.removeAttribute(kW);},RemoveClass:function(kX,kY){Z(kX).removeClass(kY);},RemoveNode:function(kZ,k0){return k0.parentNode===kZ?void kZ.removeChild(k0):null;},SetAttr:function(k1,k2,k3){return k1.setAttribute(k2,k3);},SetProperty:function($target,$name,$value){var $0=this,$this=this;return $target.setProperty($name,$value);},SetStyle:function(k4,k5,k6){return z.SetProperty(k4.style,k5,k6);}},DoubleInterpolation:$.Class({Interpolate:function(k7,k8,k9){return k8+k7*(k9-k8);}}),Easing:$.Class({},{Custom:function(k_){return $.New(_0,{TransformTime:k_});},get_CubicInOut:function(){return _1.CubicInOut();}}),Easings:{CubicInOut:$.Field(function(){return $.New(_0,{TransformTime:function(k$){var la;la=k$*k$;return 3*la-2*(la*k$);}});})},Flow:$.Class({},{Bind:function(lb,lc){return{Render:function(ld){return function(le){return(lb.Render.call(null,ld))(function(lf){return(lc(lf).Render.call(null,ld))(le);});};}};},Map:function(lg,lh){return{Render:function(li){return function(lj){return(lh.Render.call(null,li))(function(lk){return lj(lg(lk));});};}};},Return:function(ll){return{Render:function(){return function(ln){return ln(ll);};}};},get_Do:function(){return _2.New();}}),Flow1:$.Class({},{Define:function(lo){return{Render:function(lp){return function(lq){return A.Set(lp,lo(lq));};}};},Embed:function(lr){var ls;ls=A.Create(K.get_Empty());(lr.Render.call(null,ls))(function(){});return K.EmbedView(ls.get_View());},Static:function(lu){return{Render:function(lv){return function(lw){A.Set(lv,lu);return lw(null);};}};}}),FlowBuilder:$.Class({Bind:function(lx,ly){return _3.Bind(lx,ly);},Return:function(lz){return _3.Return(lz);},ReturnFrom:function(lA){return lA;}},{New:function(){return $.New(this,{});}}),Html:{attr:$.Class({},{New:function(){return $.New(this,{});}})},Input:{ActivateButtonListener:$.Field(function(){var lB,lF;lB=function(lC,lD){var lE;lE=lC.button;return lE===0?A.Set(_4.MouseBtnSt1().Left,lD):lE===1?A.Set(_4.MouseBtnSt1().Middle,lD):lE===2?A.Set(_4.MouseBtnSt1().Right,lD):null;};if(!_4.MouseBtnSt1().Active){_4.MouseBtnSt1().Active=true;H.addEventListener("mousedown",function(lG){return lB(lG,true);},false);lF=H.addEventListener("mouseup",function(lH){return lB(lH,false);},false);}else{lF=null;}return lF;}),ActivateKeyListener:$.Field(function(){var lI;if(!_4.KeyListenerState().KeyListenerActive){Z(H).keydown(function(lJ){var lK,lL;lK=lJ.which;A.Set(_4.KeyListenerState().LastPressed,lK);lL=A.Get(_4.KeyListenerState().KeysPressed);return!d.exists(function(lM){return lM===lK;},lL)?_4.KeyListenerState().KeysPressed.set_Value(C.append(lL,C.ofArray([lK]))):null;});lI=void Z(H).keyup(function(lN){var lO,lP,lR;lO=lN.which;lP=function(lQ){return lQ!==lO;};lR=function(lS){return C.filter(lP,lS);};return N.Update(_4.KeyListenerState().KeysPressed,lR);});}else{lI=null;}return lI;}),KeyListenerState:$.Field(function(){return{KeysPressed:A.Create($.New(_5,{$:0})),KeyListenerActive:false,LastPressed:A.Create(-1)};}),Keyboard:$.Class({},{IsPressed:function(lT){var lU;_4.ActivateKeyListener();lU=function(lV){return lV===lT;};return w.Map(function(lW){return d.exists(lU,lW);},_4.KeyListenerState().KeysPressed.get_View());},get_KeysPressed:function(){_4.ActivateKeyListener();return _4.KeyListenerState().KeysPressed.get_View();},get_LastPressed:function(){_4.ActivateKeyListener();return _4.KeyListenerState().LastPressed.get_View();}}),Mouse:$.Class({},{get_LeftPressed:function(){_4.ActivateButtonListener();return _4.MouseBtnSt1().Left.get_View();},get_MiddlePressed:function(){_4.ActivateButtonListener();return _4.MouseBtnSt1().Middle.get_View();},get_MousePressed:function(){_4.ActivateButtonListener();return G.Apply(G.Apply(G.Apply(G.Const(function(lX){return function(lY){return function(lZ){return(lX?true:lY)?true:lZ;};};}),_4.MouseBtnSt1().Left.get_View()),_4.MouseBtnSt1().Middle.get_View()),_4.MouseBtnSt1().Right.get_View());},get_Position:function(){var l0;l0=function(l1){return A.Set(_4.MousePosSt1().PosV,[l1.clientX,l1.clientY]);};if(!_4.MousePosSt1().Active){H.addEventListener("mousemove",l0,false);_4.MousePosSt1().Active=true;}return w.FromVar(_4.MousePosSt1().PosV);},get_RightPressed:function(){_4.ActivateButtonListener();return _4.MouseBtnSt1().Right.get_View();}}),MouseBtnSt1:$.Field(function(){return{Active:false,Left:A.Create(false),Middle:A.Create(false),Right:A.Create(false)};}),MousePosSt1:$.Field(function(){return{Active:false,PosV:A.Create([0,0])};})},Interpolation1:$.Class({},{get_Double:function(){return $.New(_6,{$:0});}}),Key:$.Class({},{Fresh:function(){return $.New(_7,{$:0,$0:h.Int()});}}),ListModel:$.Class({Add:function(l2){var l3,l5=this;l3=this.Var.get_Value();if(!_8.Contains(this.Key,l2,l3)){l3.push(l2);return this.Var.set_Value(l3);}else{a.set(l3,a.findINdex(function(l4){return m.Equals(l5.Key.call(null,l4),l5.Key.call(null,l2));},l3),l2);return l5.Var.set_Value(l3);}},Clear:function(){return this.Var.set_Value([]);},ContainsKey:function(l6){var l8=this;return d.exists(function(l7){return m.Equals(l8.Key.call(null,l7),l6);},l8.Var.get_Value());},ContainsKeyAsView:function(l9){var l_,ma=this;l_=function(l$){return m.Equals(ma.Key.call(null,l$),l9);};return w.Map(function(mb){return d.exists(l_,mb);},ma.Var.get_View());},Find:function(mc){return a.find(mc,this.Var.get_Value());},FindAsView:function(md){return w.Map(function(me){return a.find(md,me);},this.Var.get_View());},FindByKey:function(mf){var mh=this;return a.find(function(mg){return m.Equals(mh.Key.call(null,mg),mf);},mh.Var.get_Value());},FindByKeyAsView:function(mi){var mj,ml=this;mj=function(mk){return m.Equals(ml.Key.call(null,mk),mi);};return w.Map(function(mm){return a.find(mj,mm);},ml.Var.get_View());},Iter:function(mn){return a.iter(mn,this.Var.get_Value());},Remove:function(mo){var mp,mq,mr;mp=this.Var.get_Value();if(_8.Contains(this.Key,mo,mp)){mq=this.Key;mr=mq(mo);return this.Var.set_Value(a.filter(function(ms){return!m.Equals(mq(ms),mr);},mp));}else{return null;}},RemoveBy:function(mt){return this.Var.set_Value(a.filter(function(mu){return!mt(mu);},this.Var.get_Value()));},RemoveByKey:function(mv){var mx=this;return this.Var.set_Value(a.filter(function(mw){return!m.Equals(mx.Key.call(null,mw),mv);},mx.Var.get_Value()));},Set:function(my){return this.Var.set_Value(a.ofSeq(my));},TryFind:function(mz){return a.tryFind(mz,this.Var.get_Value());},TryFindAsView:function(mA){return w.Map(function(mB){return a.tryFind(mA,mB);},this.Var.get_View());},TryFindByKey:function(mC){var mE=this;return a.tryFind(function(mD){return m.Equals(mE.Key.call(null,mD),mC);},mE.Var.get_Value());},TryFindByKeyAsView:function(mF){var mG,mI=this;mG=function(mH){return m.Equals(mI.Key.call(null,mH),mF);};return w.Map(function(mJ){return a.tryFind(mG,mJ);},mI.Var.get_View());},UpdateAll:function(mK){return N.Update(this.Var,function(mL){a.iteri(function(mM){return function(mN){return v.iter(function(mO){return a.set(mL,mM,mO);},mK(mN));};},mL);return mL;});},UpdateBy:function(mP,mQ){var mR,mS,mU=this,mV,mW;mR=this.Var.get_Value();mS=a.tryFindIndex(function(mT){return m.Equals(mU.Key.call(null,mT),mQ);},mR);if(mS.$==1){mV=mS.$0;mW=mP(a.get(mR,mV));if(mW.$==1){a.set(mR,mV,mW.$0);return mU.Var.set_Value(mR);}else{return null;}}else{return null;}},get_Length:function(){return a.length(this.Var.get_Value());},get_LengthAsView:function(){return w.Map(function(mX){return a.length(mX);},this.Var.get_View());}}),ListModel1:$.Class({},{Create:function(mY,mZ){var m0;m0=A.Create(d.toArray(O.distinctBy(mY,mZ)));return $.New(_9,{Key:mY,Var:m0,View:w.Map(function(m1){return m1.slice();},m0.get_View())});},FromSeq:function(m2){return _.Create(function(m3){return m3;},m2);},View:function(m4){return m4.View;}}),ListModels:{Contains:function(m5,m6,m7){var m8;m8=m5(m6);return d.exists(function(m9){return m.Equals(m5(m9),m8);},m7);}},Model:$.Class({get_View:function(){return ba.View(this);}},{Create:function(m_,m$){var na;na=A.Create(m$);return $.New(bb,{$:0,$0:na,$1:w.Map(m_,na.get_View())});},Update:function(nb,nc){return N.Update(nc.$0,function(nd){nb(nd);return nd;});}}),Model1:$.Class({},{View:function(ne){return ne.$1;}}),Route:{Append:function(nf,ng){return{$:0,$0:p.Append(nf.$0,ng.$0)};},FromList:function(nh){return{$:0,$0:p.FromArray(a.ofSeq(nh))};},MakeHash:function(ni){return bc.concat("/",a.map(function(nj){return bd(nj);},p.ToArray(ni.$0)));},NoHash:function(nk){return bc.StartsWith(nk,"#")?nk.substring(1):nk;},ParseHash:function(nl){return{$:0,$0:p.FromArray(a.map(function(nm){return be(nm);},bc.SplitChars(bf.NoHash(nl),[47],1)))};},SameHash:function(nn,no){return bf.NoHash(nn)===bf.NoHash(no);},ToList:function(np){return C.ofArray(p.ToArray(np.$0));}},RouteMap:$.Class({},{Create:function(nq,nr){return{Des:nr,Ser:nq};},Install:function(ns){return bg.InstallMap(ns);}}),Router1:$.Class({},{Dir:function(nt,nu){return bh.Prefix(nt,bh.Merge(nu));},Install:function(nv,nw){return bg.Install(nv,nw);},Merge:function(nx){return bg.MergeRouters(nx);},Prefix:function(ny,nz){return{$:0,$0:nz.$0,$1:bi.Prefix(ny,nz.$1)};},Route:function(nA,nB,nC){return bg.DefineRoute(nA,nB,nC);}}),Routing:{ComputeBodies:function(nD){var nE;nE=bj.New12();a.iter(function(nF){return nE.set_Item(nF.RouteId,nF);},bi.ToArray(nD));return nE;},DefineRoute:function(nG,nH,nI){var nJ,nK,nL,nM;nJ=A.Create(nH);nK=h.Int();nL=(nI({$:0,$0:nK}))(nJ);nM=bi.Leaf({$:0,$0:nK,$1:function(nN){G.Sink(function(nO){return nN.UpdateRoute.call(null,bg.DoLink(nG,nO));},nJ.get_View());return{OnRouteChanged:function(nP){return nJ.set_Value(bg.DoRoute(nG,nP));},OnSelect:function(){return nN.UpdateRoute.call(null,bg.DoLink(nG,nJ.get_Value()));},RouteId:nK,RouteValue:nL};}});return{$:0,$0:{$:1,$0:nL},$1:nM};},DoLink:function(nR,nS){return bf.FromList(nR.Ser.call(null,nS));},DoRoute:function(nT,nU){return nT.Des.call(null,bf.ToList(nU));},Install:function(nV,nW){var nX,nY,nZ,n2,n3,n8,n_,n$,oa,oc;nX=nW.$0;nY=nW.$1;nZ=bg.InstallMap({Des:function(n0){return bf.FromList(n0);},Ser:function(n1){return bf.ToList(n1);}});n2={Bodies:g.U(),CurrentRoute:nZ,CurrentSite:0,Selection:g.U()};n3=bi.Map(function(n4){return function(n5){var n6;n6=n5.$0;return n5.$1.call(null,{UpdateRoute:function(n7){return bg.OnInternalSiteUpdate(n2,n6,n4,n7);}});};},nY);n2.Bodies=bg.ComputeBodies(n3);n8=function(n9){return bi.Lookup(n3,bf.ToList(n9));};n_=n8(nZ.get_Value());if(n_.$==0){oa=n_.$0;n2.CurrentSite=oa.RouteId;n$=A.Create(oa.RouteValue);}else{n$=A.Create(nX.$==1?nX.$0:P.FailWith("Site.Install fails on empty site"));}n2.Selection=n$;G.Sink(function(ob){return bg.OnSelectSite(n2,nV(ob));},n$.get_View());oc=function(od){var oe;oe=n8(od);return oe.$==1?null:bg.OnGlobalRouteChange(n2,oe.$0,bf.FromList(oe.$1));};oc(nZ.get_Value());G.Sink(oc,nZ.get_View());return n$;},InstallMap:function(of){var og,oi,oj;og=function(){return of.Des.call(null,bf.ToList(bf.ParseHash(r.location.hash)));};oi=A.Create(og(null));oj=function(){var ol;ol=og(null);return!m.Equals(of.Ser.call(null,oi.get_Value()),of.Ser.call(null,ol))?oi.set_Value(ol):null;};r.onpopstate=oj;r.onhashchange=oj;G.Sink(function(om){var on;on=bf.MakeHash(bf.FromList(of.Ser.call(null,om)));return!bf.SameHash(r.location.hash,on)?void(r.location.hash=on):null;},oi.get_View());return oi;},MergeRouters:function(oo){var op,oq,os;op=d.toArray(oo);oq=bi.Merge(d.map(function(or){return or.$1;},op));os=d.tryPick(function(ot){return ot.$0;},op);return oq.$==1?{$:0,$0:os,$1:oq.$0}:P.FailWith("Invalid Site.Merge: need more prefix disambiguation");},OnGlobalRouteChange:function(ou,ov,ow){if(ou.CurrentSite!==ov.RouteId){ou.CurrentSite=ov.RouteId;ou.Selection.set_Value(ov.RouteValue);}return ov.OnRouteChanged.call(null,ow);},OnInternalSiteUpdate:function(ox,oy,oz,oA){return ox.CurrentSite===oy?bg.SetCurrentRoute(ox,bf.Append(bf.FromList(oz),oA)):null;},OnSelectSite:function(oB,oC){var oD;oD=oC.$0;if(oB.CurrentSite!==oD){oB.CurrentSite=oD;return oB.Bodies.get_Item(oD).OnSelect.call(null,null);}else{return null;}},SetCurrentRoute:function(oE,oF){return!m.Equals(oE.CurrentRoute.get_Value(),oF)?oE.CurrentRoute.set_Value(oF):null;}},Snap1:{Bind:function(oG,oH){var oI,oJ;oI=bk.Create();oJ=function(){return bk.MarkObsolete(oI);};bk.When(oH,function(oL){var oM;oM=oG(oL);return bk.When(oM,function(oN){return(bk.IsForever(oM)?bk.IsForever(oH):false)?bk.MarkForever(oI,oN):bk.MarkReady(oI,oN);},oJ);},oJ);return oI;},Create:function(){return bk.Make({$:3,$0:[],$1:[]});},CreateForever:function(oO){return bk.Make({$:0,$0:oO});},CreateWithValue:function(oP){return bk.Make({$:2,$0:oP,$1:[]});},IsForever:function(oQ){return oQ.State.$==0?true:false;},IsObsolete:function(oR){return oR.State.$==1?true:false;},Make:function(oS){return{State:oS};},Map:function(oT,oU){var oV,oW;oV=oU.State;if(oV.$==0){return bk.CreateForever(oT(oV.$0));}else{oW=bk.Create();bk.When(oU,function(oX){return bk.MarkDone(oW,oU,oT(oX));},function(){return bk.MarkObsolete(oW);});return oW;}},Map2:function(oZ,o0,o1){var o2,o3,o4,o6,o7,o8,o9,o$;o2=[o0.State,o1.State];if(o2[0].$==0){if(o2[1].$==0){o3=o2[1].$0;return bk.CreateForever((oZ(o2[0].$0))(o3));}else{return bk.Map(oZ(o2[0].$0),o1);}}else{if(o2[1].$==0){o4=o2[1].$0;return bk.Map(function(o5){return(oZ(o5))(o4);},o0);}else{o6=bk.Create();o7=[{$:0}];o8=[{$:0}];o9=function(){o7[0]={$:0};o8[0]={$:0};return bk.MarkObsolete(o6);};o$=function(){var pb,pc,pd;pb=[o7[0],o8[0]];if(pb[0].$==1){if(pb[1].$==1){pc=pb[0].$0;pd=pb[1].$0;return(bk.IsForever(o0)?bk.IsForever(o1):false)?bk.MarkForever(o6,(oZ(pc))(pd)):bk.MarkReady(o6,(oZ(pc))(pd));}else{return null;}}else{return null;}};bk.When(o0,function(pe){o7[0]={$:1,$0:pe};return o$(null);},o9);bk.When(o1,function(pf){o8[0]={$:1,$0:pf};return o$(null);},o9);return o6;}}},MapAsync:function(pg,ph){var pi;pi=bk.Create();bk.When(ph,function(pj){return bl.StartTo(pg(pj),function(pk){return bk.MarkDone(pi,ph,pk);});},function(){return bk.MarkObsolete(pi);});return pi;},MarkDone:function(pm,pn,po){return bk.IsForever(pn)?bk.MarkForever(pm,po):bk.MarkReady(pm,po);},MarkForever:function(pp,pq){var pr,ps;pr=pp.State;if(pr.$==3){ps=pr.$0;pp.State={$:0,$0:pq};return l.Iter(function(pt){return pt(pq);},ps);}else{return null;}},MarkObsolete:function(pu){var pv,pw,py;pv=pu.State;if(pv.$==1){return null;}else{if(pv.$==2){pw=pv.$1;pu.State={$:1};return l.Iter(function(px){return px(null);},pw);}else{if(pv.$==3){py=pv.$1;pu.State={$:1};return l.Iter(function(pz){return pz(null);},py);}else{return null;}}}},MarkReady:function(pA,pB){var pC,pD;pC=pA.State;if(pC.$==3){pD=pC.$0;pA.State={$:2,$0:pB,$1:pC.$1};return l.Iter(function(pE){return pE(pB);},pD);}else{return null;}},SnapshotOn:function(pF,pG){var pH,pI,pJ,pK,pL;pH=[pF.State,pG.State];if(pH[1].$==0){return bk.CreateForever(pH[1].$0);}else{pI=bk.Create();pJ=[{$:0}];pK=[false];pL=function(){var pN;if(pK[0]){pN=pJ[0];return pN.$==1?bk.IsForever(pG)?bk.MarkForever(pI,pN.$0):pN.$==1?bk.MarkReady(pI,pN.$0):null:pN.$==1?bk.MarkReady(pI,pN.$0):null;}else{return null;}};bk.When(pF,function(){pK[0]=true;return pL(null);},function(){pJ[0]={$:0};return bk.MarkObsolete(pI);});bk.When(pG,function(pQ){pJ[0]={$:1,$0:pQ};return pL(null);},function(){});return pI;}},When:function(pS,pT,pU){var pV,pW,pX;pV=pS.State;if(pV.$==1){return pU(null);}else{if(pV.$==2){pW=pV.$0;l.Add(pU,pV.$1);return pT(pW);}else{if(pV.$==3){pX=pV.$1;l.Add(pT,pV.$0);return l.Add(pU,pX);}else{return pT(pV.$0);}}}}},Trans1:$.Class({},{AnimateChange:function(pY,pZ,p0){return(pY.TChange.call(null,pZ))(p0);},AnimateEnter:function(p1,p2){return p1.TEnter.call(null,p2);},AnimateExit:function(p3,p4){return p3.TExit.call(null,p4);},CanAnimateChange:function(p5){return(p5.TFlags&1)!==0;},CanAnimateEnter:function(p6){return(p6.TFlags&2)!==0;},CanAnimateExit:function(p7){return(p7.TFlags&4)!==0;},Change:function(p8,p9){return{TChange:p8,TEnter:p9.TEnter,TExit:p9.TExit,TFlags:p9.TFlags|1};},Create:function(p_){return{TChange:p_,TEnter:function(p$){return o.Const(p$);},TExit:function(qa){return o.Const(qa);},TFlags:1};},Enter:function(qb,qc){return{TChange:qc.TChange,TEnter:qb,TExit:qc.TExit,TFlags:qc.TFlags|2};},Exit:function(qd,qe){return{TChange:qe.TChange,TEnter:qe.TEnter,TExit:qd,TFlags:qe.TFlags|4};},Trivial:function(){return{TChange:function(){return function(qg){return o.Const(qg);};},TEnter:function(qh){return o.Const(qh);},TExit:function(qi){return o.Const(qi);},TFlags:0};}}),Trie1:{AllSome:function(qj){var qk,ql,qm,qn;qk=bm.Get(qj);ql=bo.New2();qm=true;while(qm?qk.MoveNext():false){qn=qk.get_Current();if(qn.$==1){ql.Add(qn.$0);}else{qm=false;}}return qm?{$:1,$0:ql.ToArray()}:{$:0};},Empty:function(){return{$:1};},IsLeaf:function(qo){return qo.$==2?true:false;},Leaf:function(qp){return{$:2,$0:qp};},Look:function(qq,qr){var qs,qt,qu;qs=[qr,qq];if(qs[0].$==2){return{$:0,$0:qs[0].$0,$1:qq};}else{if(qs[0].$==0){if(qs[1].$==1){qt=qs[1].$1;qu=bp.TryFind(qs[1].$0,qs[0].$0);return qu.$==0?{$:1}:bi.Look(qt,qu.$0);}else{return{$:1};}}else{return{$:1};}}},Lookup:function(qv,qw){return bi.Look(d.toList(qw),qv);},Map:function(qx,qy){return bi.MapLoop($.New(_5,{$:0}),qx,qy);},MapLoop:function(qz,qA,qB){var qC;if(qB.$==1){return{$:1};}else{if(qB.$==2){qC=qB.$0;return{$:2,$0:(qA(qz))(qC)};}else{return bi.TrieBranch(bp.Map(function(qD){return function(qE){return bi.MapLoop(C.append(qz,C.ofArray([qD])),qA,qE);};},qB.$0));}}},Mapi:function(qF,qG){var qH;qH=[0];return bi.Map(function(qI){var qJ;qJ=qH[0];qH[0]=qJ+1;return(qF(qJ))(qI);},qG);},Merge:function(qK){var qL,qM;qL=d.toArray(qK);qM=a.length(qL);return qM===0?{$:1,$0:{$:1}}:qM===1?{$:1,$0:a.get(qL,0)}:d.exists(function(qN){return bi.IsLeaf(qN);},qL)?{$:0}:v.map(function(qO){return bi.TrieBranch(qO);},bi.MergeMaps(function(qP){return bi.Merge(qP);},d.choose(function(qQ){return qQ.$==0?{$:1,$0:qQ.$0}:{$:0};},qL)));},MergeMaps:function(qR,qS){var qT;qT=d.collect(function(qU){return bp.ToSeq(qU);},qS);return v.map(function(qV){return bp.OfArray(d.toArray(qV));},bi.AllSome(d.map(function(qW){var qX;qX=qW[0];return v.map(function(qY){return[qX,qY];},qR(qW[1]));},bp.ToSeq(d.fold(function(qZ){return function(q0){return bi.MultiAdd(q0[0],q0[1],qZ);};},bq.New1([]),qT)))));},MultiAdd:function(q1,q2,q3){return q3.Add(q1,$.New(_5,{$:1,$0:q2,$1:bi.MultiFind(q1,q3)}));},MultiFind:function(q4,q5){return P.DefaultArg(bp.TryFind(q4,q5),$.New(_5,{$:0}));},Prefix:function(q6,q7){return bi.TrieBranch(bq.New1(C.ofArray([[q6,q7]])));},ToArray:function(q8){var q9;q9=[];bi.Map(function(){return function(q$){return l.Add(q$,q9);};},q8);return l.ToArray(q9);},TrieBranch:function(ra){return ra.get_IsEmpty()?{$:1}:{$:0,$0:ra};}},Var:$.Class({get_Value:function(){return A.Get(this);},get_View:function(){return w.FromVar(this);},set_Value:function(rb){return A.Set(this,rb);}},{Create:function(rc){return $.New(A,{Const:false,Current:rc,Snap:bk.CreateWithValue(rc),Id:h.Int()});},Get:function(rd){return rd.Current;},Set:function(re,rf){if(re.Const){return null;}else{bk.MarkObsolete(re.Snap);re.Current=rf;re.Snap=bk.CreateWithValue(rf);return;}}}),Var1:$.Class({},{GetId:function(rg){return rg.Id;},Observe:function(rh){return rh.Snap;},SetFinal:function(ri,rj){if(ri.Const){return null;}else{ri.Const=true;ri.Current=rj;ri.Snap=bk.CreateForever(rj);return;}},Update:function(rk,rl){return A.Set(rk,rl(A.Get(rk)));}}),View:$.Class({},{Convert:function(rm,rn){return w.ConvertBy(function(ro){return ro;},rm,rn);},ConvertBy:function(rp,rq,rr){var rs;rs=[bj.New12()];return w.Map(function(rt){var ru,rv,rw;ru=rs[0];rv=bj.New12();rw=a.map(function(rx){var ry,rz;ry=rp(rx);rz=ru.ContainsKey(ry)?ru.get_Item(ry):rq(rx);rv.set_Item(ry,rz);return rz;},d.toArray(rt));rs[0]=rv;return rw;},rr);},ConvertSeq:function(rA,rB){return w.ConvertSeqBy(function(rC){return rC;},rA,rB);},ConvertSeqBy:function(rD,rE,rF){var rG;rG=[bj.New12()];return w.Map(function(rH){var rI,rJ,rK;rI=rG[0];rJ=bj.New12();rK=a.map(function(rL){var rM,rN,rO;rM=rD(rL);if(rI.ContainsKey(rM)){rO=rI.get_Item(rM);A.Set(rO.NVar,rL);rN=rO;}else{rN=w.ConvertSeqNode(rE,rL);}rJ.set_Item(rM,rN);return rN.NValue;},d.toArray(rH));rG[0]=rJ;return rK;},rF);},ConvertSeqNode:function(rP,rQ){var rR,rS;rR=A.Create(rQ);rS=w.FromVar(rR);return{NValue:rP(rS),NVar:rR,NView:rS};},CreateLazy:function(rT){var rU;rU=[{$:0}];return{$:0,$0:function(){var rW,rX,rY;rW=rU[0];if(rW.$==1){if(!bk.IsObsolete(rW.$0)){return rW.$0;}else{rX=rT(null);rU[0]={$:1,$0:rX};return rX;}}else{rY=rT(null);rU[0]={$:1,$0:rY};return rY;}}};},CreateLazy2:function(rZ,r0,r1){var r2,r3;r2=r0.$0;r3=r1.$0;return w.CreateLazy(function(){var r5,r6;r5=r2(null);r6=r3(null);return(rZ(r5))(r6);});},FromVar:function(r7){return{$:0,$0:function(){return N.Observe(r7);}};},Map:function(r9,r_){var r$;r$=r_.$0;return w.CreateLazy(function(){return bk.Map(r9,r$(null));});},Map2:function(sb,sc,sd){return w.CreateLazy2(function(se){return function(sf){return bk.Map2(sb,se,sf);};},sc,sd);},MapAsync:function(sg,sh){var si;si=sh.$0;return w.CreateLazy(function(){return bk.MapAsync(sg,si(null));});},SnapshotOn:function(sk,sl,sm){var sn,so,sp,sq;sn=sl.$0;so=sm.$0;sp=bk.CreateWithValue(sk);sq=[false];return w.CreateLazy(function(){var ss,st;ss=sn(null);st=so(null);if(sq[0]){return bk.SnapshotOn(ss,st);}else{bk.When(bk.SnapshotOn(ss,st),function(){return null;},function(){if(!sq[0]){sq[0]=true;return bk.MarkObsolete(sp);}else{return null;}});return sp;}});},UpdateWhile:function(sw,sx,sy){var sz;sz=[sw];return w.Map2(function(sA){return function(sB){if(sA){sz[0]=sB;}return sz[0];};},sx,sy);},get_Do:function(){return $.New(br,{$:0});}}),View1:$.Class({},{Apply:function(sC,sD){return w.Map2(function(sE){return function(sF){return sE(sF);};},sC,sD);},Bind:function(sG,sH){return G.Join(w.Map(sG,sH));},Const:function(sI){var sJ;sJ=bk.CreateForever(sI);return{$:0,$0:function(){return sJ;}};},Join:function(sL){var sM;sM=sL.$0;return w.CreateLazy(function(){return bk.Bind(function(sO){return sO.$0.call(null,null);},sM(null));});},Sink:function(sP,sQ){var sR,sS;sR=sQ.$0;sS=function(){return bk.When(sR(null),sP,function(){return bl.Schedule(sS);});};return bl.Schedule(sS);}}),ViewBuilder:$.Class({Bind:function(sV,sW){return G.Bind(sW,sV);},Return:function(sX){return G.Const(sX);}})}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.Arrays);b=$.Safe($$.WebSharper.Concurrency);c=$.Safe($$.Array);d=$.Safe($$.WebSharper.Seq);e=$.Safe($$.WebSharper.UI);f=$.Safe(e.Next);g=$.Safe(f.Abbrev);h=$.Safe(g.Fresh);i=$.Safe($$.WebSharper.Collections);j=$.Safe(i.HashSetProxy);k=$.Safe(g.HashSet);l=$.Safe(g.JQueue);m=$.Safe($$.WebSharper.Unchecked);n=$.Safe(g.Slot);o=$.Safe(f.An);p=$.Safe(f.AppendList1);q=$.Safe(f.Anims);r=$.Safe($$.window);s=$.Safe($$.WebSharper.Lazy);t=$.Safe(g.Array);u=$.Safe(f.Trans1);v=$.Safe($$.WebSharper.Option);w=$.Safe(f.View);x=$.Safe(f.Client);y=$.Safe(x.Attrs);z=$.Safe(f.DomUtility);A=$.Safe(f.Var);B=$.Safe(x.AttrProxy);C=$.Safe($$.WebSharper.List);D=$.Safe(x.Attr);E=$.Safe(x.AnimatedAttrNode);F=$.Safe(x.DynamicAttrNode);G=$.Safe(f.View1);H=$.Safe($$.document);I=$.Safe(x.Docs);J=$.Safe(g.Mailbox);K=$.Safe(x.Doc);L=$.Safe(x.UINextPagelet);M=$.Safe(x.Elt);N=$.Safe(f.Var1);O=$.Safe($$.Seq);P=$.Safe($$.WebSharper.Operators);Q=$.Safe(I.NodeSet);R=$.Safe(x.DocElemNode);S=$.Safe(I.DomNodes);T=$.Safe($$.RegExp);U=$.Safe($$.WebSharper.Html);V=$.Safe(U.Client);W=$.Safe(V.Pagelet);X=$.Safe(V.Attr);Y=$.Safe(V.Tags);Z=$.Safe($$.jQuery);_0=$.Safe(f.Easing);_1=$.Safe(f.Easings);_2=$.Safe(f.FlowBuilder);_3=$.Safe(f.Flow);_4=$.Safe(f.Input);_5=$.Safe(C.T);_6=$.Safe(f.DoubleInterpolation);_7=$.Safe(f.Key);_8=$.Safe(f.ListModels);_9=$.Safe(f.ListModel);_=$.Safe(f.ListModel1);ba=$.Safe(f.Model1);bb=$.Safe(f.Model);bc=$.Safe($$.WebSharper.Strings);bd=$.Safe($$.encodeURIComponent);be=$.Safe($$.decodeURIComponent);bf=$.Safe(f.Route);bg=$.Safe(f.Routing);bh=$.Safe(f.Router1);bi=$.Safe(f.Trie1);bj=$.Safe(i.Dictionary);bk=$.Safe(f.Snap1);bl=$.Safe(g.Async);bm=$.Safe($$.WebSharper.Enumerator);bn=$.Safe(i.ResizeArray);bo=$.Safe(bn.ResizeArrayProxy);bp=$.Safe(i.MapModule);bq=$.Safe(i.FSharpMap);return br=$.Safe(f.ViewBuilder);});$.OnLoad(function(){$.Inherit(M,K);$.Inherit(L,W);_4.MousePosSt1();_4.MouseBtnSt1();_4.KeyListenerState();_4.ActivateKeyListener();_4.ActivateButtonListener();_1.CubicInOut();z.Doc();y.EmptyAttr();h.counter();return;});}());
